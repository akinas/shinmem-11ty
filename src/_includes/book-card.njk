{# src/_includes/book-card.njk #}
{# This template is included by index.njk and receives the 'book' variable from the loop. #}
{% set book_url = '/' ~ page.lang ~ '/books/' ~ (book.data.slug or book.fileSlug) ~ '/' %}

<div class="home-container3"> {# This container might need adjustment based on your CSS layout #}
  <div class="blog-post-card3-blog-post-card blog-post-card3-root-class-name1">
    <a href="{{ book_url }}">
      <img
        alt="{{ book.data.title }} book cover"
        src="{{ book.data.image_src }}"
        class="blog-post-card3-image"
      />
    </a>
    <div class="blog-post-card3-container">
      <span class="blog-post-card3-text">
        <span>{{ book.data.author }}</span>
      </span>
      <h1 class="blog-post-card3-text1">
        <span><a href="{{ book_url }}">{{ book.data.title }}</a>
          {% if book.data.edition_year %}
            <em style="font-size:70%;font-weight: normal;">({{ book.data.edition_year }})</em>
          {% endif %}
        </span>
      </h1>
      <div class="blog-post-card3-container1">
        <span class="blog-post-card3-text2">
          <span>{{ book.data.description | safe }}</span> {# Use | safe to render HTML from Markdown #}
        </span>
        <span class="blog-post-card3-text3"><a href="{{ book_url }}">Read More</a></span>
      </div>
      
      {# Conditional button based on book status #}
      {% if book.data.status == 'available' %}
        <a
          href="{{ book.data.buy_now_url }}"
          target="_blank"
          rel="noreferrer noopener"
          class="blog-post-card3-link"
          style="cursor:pointer;"
        >
          <div class="app-component-container">
            <button type="button" class="button home-button">
              <span>Buy Now</span>
            </button>
          </div>
        </a>
      {% else %}
        <div class="app-component-container">
          <button type="button" class="button">
            <span>Out of Print</span>
          </button>
        </div>
      {% endif %}
      
    </div>
  </div>
</div>
